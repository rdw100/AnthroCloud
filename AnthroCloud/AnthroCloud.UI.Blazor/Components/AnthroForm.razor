@inherits AnthroFormBase
@using AnthroCloud.Entities

@functions{
    public string setColor(double zscore)
    {
        var colorCode = zscore switch
        {
            double n when (n <= 1 && n >= -1) => "#eafaf1", //GREEN
            double n when (n <= -1 && n >= -2) || (n <= 2 && n > 1) => "#fef9e7", //GOLD
            double n when (n < -2 && n >= -3) || (n <= 3 && n > 2) => "#fdedec", //RED
            double n when (n > 3 || n < -3) => "#aab3bb", //BLACK
            _ => string.Empty,
        };
        return colorCode;
    }

    public string setPercentileRange(double measure)
    {
        string result = string.Empty;

        if (measure >= 99.9 || measure <= .01)
        {
            result = "NA";
        }
        else
        {
            result = measure.ToString();
        }

        return result;
    }

    public string setRangeControl(double measure, byte ageInYears, byte ageInMonths)
    {
        string result = string.Empty;

        if (ageInYears < 1 && ageInMonths < 3)
        {
            result = "50";
        }
        else
        {
            result = measure.ToString();
        }

        return result;
    }

    public string setPercText(double measure, byte ageInYears, byte ageInMonths)
    {
        string result = string.Empty;

        if (ageInYears < 1 && ageInMonths < 3)
        {
            result = "NA";
        }
        else
        {
            result = measure.ToString();
        }

        return result;
    }

    public string setZscoreText(double measure, byte ageInYears, byte ageInMonths)
    {
        string result = string.Empty;

        if (ageInYears < 1 && ageInMonths < 3)
        {
            result = "NA";
        }
        else
        {
            result = measure.ToString("0.00");
        }

        return result;
    }
}

<style>
    fieldset {
        border: 1px solid #ddd !important;
        margin: 0;
        margin-top: 5px;
        min-width: 0;
        padding: 10px;
        position: relative;
        border-radius: 4px;
        background-color: #fafafa;
        padding-left: 10px !important;
    }

    legend {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 0px;
        width: 35%;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 5px 5px 5px 10px;
        background-color: #ffffff;
    }
</style>

<h3>AnthroForm</h3>

<EditForm EditContext="@editContext" OnValidSubmit="@HandleValidSubmitAsync">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <fieldset>
        <div class="form-row">
            <div class="col-md-6 mb-2">
                @*<label class="form-control text-center">
                        Date of Birth

                    </label><InputDate @bind-Value="formModel.DateOfBirth" DisplayName="Date of Birth" />*@
                <label asp-for="DateOfBirth">Date of Birth</label>
                <input @bind-value="@formModel.DateOfBirth" asp-for="DateOfBirth" type="date" class="form-control text-center" required>
            </div>
            <div class="col-md-6 mb-2">
                @*<label class="form-control text-center">
                        Date of Visit

                    </label><InputDate @bind-Value="formModel.DateOfVisit" DisplayName="Date of Visit" />*@
                <label>Date of Visit</label>
                <input @bind-value="@formModel.DateOfVisit" asp-for="DateOfVisit" type="date" class="form-control text-center" required />
            </div>
        </div>
        <div class="form-row">
            <div class="col-md-4 mb-2">
                <InputRadioGroup Name="sex" @bind-Value="formModel.Sex">
                    Sex:
                    <br>
                    <InputRadio Name="sex" Value="Sexes.Male" />Male<br>
                    <InputRadio Name="sex" Value="Sexes.Female" />Female<br>
                </InputRadioGroup>
                @*<label class="col-form-label">Sex</label>
                    <div class="form-group">
                        <label class="d-block">
                            <input id="SexMale" asp-for="Sex" type="radio" value="1" class="ml-2 mr-2"> Male
                        </label>
                        <label class="d-block">
                            <input id="SexFemale" asp-for="Sex" type="radio" value="2" class="ml-2 mr-2"> Female
                        </label>
                    </div>*@
            </div>
            <div class="col-md-4 mb-2">
                <label class="col-form-label">Standing</label>
                <div class="form-group">
                    <label class="d-block">
                        @*<input type="radio" class="ml-2 mr-2" name="measurement" @{ if (formModel.AgeInYears < 2) { @Html.Raw("checked")  } } disabled> Recumbent*@
                    </label>
                    <label class="d-block">
                        @*<input type="radio" class="ml-2 mr-2" name="measurement" @{ if (formModel.AgeInYears>= 2) { @Html.Raw("checked")  } } disabled> Standing*@
                    </label>
                </div>
            </div>
            <div class="col-md-4 mb-2">
                <label class="col-form-label">Oedema</label>
                <div class="form-group">
                    <label class="d-block">
                        <input id="OedemaYes" asp-for="Oedema" type="radio" class="ml-2 mr-2" value="True"> Yes
                    </label>
                    <label class="d-block">
                        <input id="OedemaNo" asp-for="Oedema" type="radio" class="ml-2 mr-2" value="False"> No
                    </label>
                </div>
            </div>
        </div>
        <div class="form-row">
            <div class="form-group col-md-6">
                <div class="form-group row">
                    <label class="col-sm-5 col-form-label">Weight (kg)</label>
                    <div class="col-sm-7">
                        <input asp-for="Weight"
                               class="form-control text-center"
                               type="number"
                               MIN=".9" MAX="58" STEP=".1"
                               placeholder="Weight (kg)"
                               required
                               data-error-msg="Must be .9 and 58"
                               @bind-value="@formModel.Weight" />
                    </div>
                    <div class="invalid-feedback">
                        Please choose a unique and valid username.
                    </div>
                    <div class="invalid-tooltip">
                        Please choose a unique and valid username.
                    </div>
                </div>
                <div class="form-group row">
                    <label for="validationDefault02" class="col-sm-5 col-form-label">Head Circumference (cm)</label>
                    <div class="col-sm-7">
                        <input asp-for="HeadCircumference" @bind-value="@formModel.HeadCircumference" class="form-control text-center" type="number" MIN="25.0" MAX="64.0" STEP=".1" id="validationDefault02" required>@*SIZE="6"*@
                    </div>
                </div>
                <div class="form-group row">
                    <label for="validationDefault03" class="col-sm-5 col-form-label">MUAC (cm)</label>
                    <div class="col-sm-7">
                        <input asp-for="MUAC" @bind-value="@formModel.MUAC" class="form-control text-center" type="number" MIN="6.0" MAX="35.0" STEP=".1" id="validationDefault03" required>
                    </div>
                </div>
            </div>
            <div class="form-group col-md-6">
                <div class="form-group row">
                    <label class="col-sm-5 col-form-label">Length/Height (cm)</label>
                    <div class="col-sm-7">
                        <input asp-for="LengthHeight"
                               class="form-control text-center"
                               type="number"
                               MIN="45.0" MAX="120.0" STEP=".1"
                               placeholder="Length/Height (cm)"
                               required
                               data-error-msg="Must be 45.0 and 120.0"
                               @bind-value="@formModel.LengthHeight" />
                    </div>
                </div>
                <div class="form-group row">
                    <label for="validationDefault05" class="col-sm-5 col-form-label">Triceps skinfold (mm)</label>
                    <div class="col-sm-7">
                        <input asp-for="TricepsSkinFold" @bind-value="formModel.TricepsSkinFold" class="form-control text-center" type="number" MIN="1.8" MAX="40.0" STEP=".1" id="validationDefault05" required>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="validationDefault06" class="col-sm-5 col-form-label">Subscapular skinfold (mm)</label>
                    <div class="col-sm-7">
                        <input asp-for="SubscapularSkinFold" @bind-value="formModel.SubscapularSkinFold" class="form-control text-center" type="number" MIN="1.8" MAX="40.0" STEP=".1" id="validationDefault06" required>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12 justify-content-center">
            <button class="btn btn-primary btn-block" type="submit">Submit</button>
            @*<button class="btn btn-primary btn-block"
                    type="submit"
                    onclick="displayBusyIndicator()">
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" id="loading" style="display:none;"></span>
                    Calculate
                </button>*@
        </div>
    </fieldset>
</EditForm>
@if (formModel != null && !loadFailed)
{
    <fieldset>
        <legend>Results:</legend>
        <div class="form-row">
            <div class="col-md-6 mb-2">
                <label>Age:</label>
                <input asp-for="Age" value="@formModel.AgeString" class="form-control text-center" type="text" readonly />
            </div>
            <div class="col-md-6 mb-2">
                <label>BMI:</label>
                <input asp-for="BMI" value="@formModel.BMI" class="form-control text-center" type="text" placeholder="..." readonly />
            </div>
        </div>
        <div class="form-row">
            <!-- Header -->
            <div class="form-group col-md-6 mb-0">
                <div class="form-group row mb-0">
                    <label class="text-nowrap text-right col-md-7 mt-1 mr-1">Percentile</label>
                    <label class="text-nowrap text-left col-md-4 mt-1 mr-1">Z-score</label>
                </div>
            </div>
            <div class="form-group col-md-6 mb-0">
                <div class="form-group row mb-0">
                    <label class="text-nowrap text-right col-md-7 mt-1 mr-1">Percentile</label>
                    <label class="text-nowrap text-left col-md-4 mt-1 mr-1">Z-score</label>
                </div>
            </div>

            @if (formModel != null && formModel.AgeInYears < 2)
            {
                <!-- Weight For Length -->
                <div class="form-group col-md-6">
                    <div class="form-group row mb-0">
                        <label class="text-nowrap col-md-3 mt-1 mr-1">Weight-for-Length</label>
                        <input id="WflPercentileRange" class="form-control-range col-md-2 mr-1 ml-1" asp-for="WflPercentile" type="range" min="0" max="100" step=".1" title="@formModel.WflPercentile" value="@formModel.WflPercentile" list="tickmarks" disabled />
                        @if (formModel != null && formModel.Oedema == true)
                        {
                            <input type="text" asp-for="WflPercentile" class="form-control col-md-2 mr-1 text-center" value="NA" readonly>
                            <input type="text" asp-for="WflZscore" class="form-control col-md-2 mr-1 text-center" value="NA" style="background-color: @setColor(formModel.WflZscore)" readonly>
                            <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="Weight-for-length Percentile" asp-controller="LineChart" asp-action="WFL_P" onclick="return true">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                            <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="Weight-for-length Z-score" asp-controller="LineChart" asp-action="WFL_Z" onclick="return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                        }
                        else
                        {
                            <input type="text" asp-for="WflPercentile" value="@setPercentileRange(@formModel.WflPercentile)" class="form-control col-md-2 mr-1 text-center" readonly>
                            <input type="text" asp-for="WflZscore" value="@formModel.WflZscore.ToString("0.00")" class="form-control col-md-2 mr-1 text-center" style="background-color: @setColor(formModel.WflZscore)" readonly>
                            <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Weight-for-length Percentile" asp-controller="LineChart" asp-action="WFL_P" onclick="basicPopup(this.href+ '?s=' + getRadioValue() + '&x=' + @formModel.LengthHeight + '&y=' + @formModel.Weight);return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                            <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Weight-for-length Z-score" asp-controller="LineChart" asp-action="WFL_Z" onclick="basicPopup(this.href+ '?s=' + getRadioValue() + '&x=' + @formModel.LengthHeight + '&y=' + @formModel.Weight);return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                        }
                    </div>
                </div>
            }
            else
            {
                <!-- Weight For Height -->
                <div class="form-group col-md-6">
                    <div class="form-group row mb-0">
                        <label class="text-nowrap col-md-3 mt-1 mr-1">Weight-for-Height</label>
                        <input id="WfhPercentileRange" class="form-control-range col-md-2 mr-1 ml-1" asp-for="WfhPercentile" type="range" min="0" max="100" step=".1" title="@formModel.WfhPercentile" value="@formModel.WfhPercentile" list="tickmarks" disabled />
                        @if (formModel != null && formModel.Oedema == true)
                        {
                            <input type="text" asp-for="WfhPercentile" class="form-control col-md-2 mr-1 text-center" value="NA" readonly>
                            <input type="text" asp-for="WfhZscore" class="form-control col-md-2 mr-1 text-center" value="NA" style="background-color: @setColor(formModel.WfhZscore)" readonly>
                            <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="Weight-for-height Percentile" asp-controller="LineChart" asp-action="WFH_P" onclick="return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                            <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="Weight-for-height Z-score" asp-controller="LineChart" asp-action="WFH_Z" onclick="return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                        }
                        else
                        {
                            <input type="text" asp-for="WfhPercentile" value="@setPercentileRange(@formModel.WfhPercentile)" class="form-control col-md-2 mr-1 text-center" readonly>
                            <input type="text" asp-for="WfhZscore" value="@formModel.WfhZscore.ToString("0.00")" class="form-control col-md-2 mr-1 text-center" style="background-color: @setColor(formModel.WfhZscore)" readonly>
                            <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Weight-for-height Percentile" asp-controller="LineChart" asp-action="WFH_P" onclick="basicPopup(this.href+ '?s=' + getRadioValue() + '&x=' + @formModel.LengthHeight + '&y=' + @formModel.Weight);return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                            <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Weight-for-height Z-score" asp-controller="LineChart" asp-action="WFH_Z" onclick="basicPopup(this.href+ '?s=' + getRadioValue() + '&x=' + @formModel.LengthHeight + '&y=' + @formModel.Weight);return false">
                                <span class="oi oi-graph" aria-hidden="true"></span>
                            </a>
                        }
                    </div>
                </div>
            }
            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="col-md-3 mt-1 mr-1">HC-for-age</label>
                    <input id="HcaPercentileRange" class="form-control-range col-md-2 mr-1" asp-for="HcaPercentile" type="range" min="0" max="100" step=".1" title="@formModel.HcaPercentile" value="@formModel.HcaPercentile" list="tickmarks" disabled />
                    <input type="text" asp-for="HcaPercentile" value="@setPercentileRange(@formModel.HcaPercentile)" class="form-control col-md-2 mr-1 text-center" readonly>
                    <input type="text" asp-for="HcaZscore" value="@formModel.HcaZscore.ToString("0.00")" class="form-control col-md-2 mr-1 text-center" style="background-color: @setColor(formModel.HcaZscore)" readonly>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Head Circumference Percentile" asp-controller="LineChart" asp-action="HCA_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.HeadCircumference);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Head Circumference Z-score" asp-controller="LineChart" asp-action="HCA_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.HeadCircumference);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
            <!-- Weight For Age -->
            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="text-nowrap col-md-3 mt-1 mr-1">Weight-for-Age</label>
                    <input id="WfaPercentileRange" class="form-control-range col-md-2 mr-1 ml-1" asp-for="WfaPercentile" type="range" min="0" max="100" step=".1" title="@formModel.WfaPercentile" value="@formModel.WfaPercentile" list="tickmarks" disabled />
                    @if (formModel != null && formModel.Oedema == true)
                    {
                        <input type="text" asp-for="WfaPercentile" class="form-control col-md-2 mr-1 text-center" value="NA" readonly>
                        <input type="text" asp-for="WfaZscore" class="form-control col-md-2 mr-1 text-center" value="NA" style="background-color: @setColor(formModel.WfaZscore)" readonly>
                        <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="Weight-for-age Percentile" asp-controller="LineChart" asp-action="WFA_P" onclick="return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                        <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="Weight-for-age Z-score" asp-controller="LineChart" asp-action="WFA_Z" onclick="return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                    }
                    else
                    {
                        <input class="form-control col-md-2 mr-1 text-center" type="text" asp-for="WfaPercentile" value="@setPercentileRange(@formModel.WfaPercentile)" readonly>
                        <input class="form-control col-md-2 mr-1 text-center" type="text" asp-for="WfaZscore" value="@formModel.WfaZscore.ToString("0.00")" style="background-color: @setColor(formModel.WfaZscore)" readonly>
                        <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Weight-for-age Percentile" asp-controller="LineChart" asp-action="WFA_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.Weight);return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                        <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Weight-for-age Z-score" asp-controller="LineChart" asp-action="WFA_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.Weight);return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                    }
                </div>
            </div>
            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="text-nowrap col-md-3 mt-1 mr-1">MUAC-for-age</label>
                    <input id="MuacPercentileRange" class="form-control-range col-md-2 mr-1" asp-for="MuacPercentile" type="range" min="0" max="100" step=".1" title="@setRangeControl(@formModel.MuacPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" value="@setRangeControl(@formModel.MuacPercentile, @formModel.AgeInYears, @formModel.AgeInMonths)" list="tickmarks" disabled />
                    <input class="form-control col-md-2 mr-1 text-center" type="text" asp-for="MuacPercentile" value="@setPercText(@formModel.MuacPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" readonly>
                    <input class="form-control col-md-2 mr-1 text-center" type="text" asp-for="MuacZscore" value="@setZscoreText(@formModel.MuacZscore,@formModel.AgeInYears, @formModel.AgeInMonths)" style="background-color: @setColor(formModel.MuacZscore)" readonly>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="MUAC Percentile" asp-controller="LineChart" asp-action="MUAC_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.MUAC );return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="MUAC Z-score" asp-controller="LineChart" asp-action="MUAC_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.MUAC);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
            <!-- Length For Age -->
            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="text-nowrap col-md-3 mt-1 mr-1">Length-for-Age</label>
                    <input id="LfaPercentileRange" class="form-control-range  col-md-2 mr-1 ml-1" asp-for="LfaPercentile" type="range" min="0" max="100" step=".1" title="@formModel.LfaPercentile" value="@formModel.LfaPercentile" list="tickmarks" disabled />
                    <input type="text" asp-for="LfaPercentile" value="@setPercText(@formModel.LfaPercentile,@formModel.AgeInYears, @formModel.AgeInMonths)" class="form-control col-md-2 mr-1 text-center" readonly>
                    <input type="text" asp-for="LfaZscore" value="@formModel.LfaZscore.ToString("0.00")" class="form-control col-md-2 mr-1 text-center" style="background-color: @setColor(formModel.LfaZscore)" readonly>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Length/Height-for-age Percentile" asp-controller="LineChart" asp-action="LHFA_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.LengthHeight);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Length/Height-for-age Z-score" asp-controller="LineChart" asp-action="LHFA_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue()  + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.LengthHeight);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="text-nowrap col-md-3 mt-1 mr-1">TSF-for-age</label>
                    <input id="TsfPercentileRange" class="form-control-range col-md-2 mr-1" asp-for="TsfPercentile" type="range" min="0" max="100" step=".1" title="@setRangeControl(@formModel.TsfPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" value="@setRangeControl(@formModel.TsfPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" list="tickmarks" disabled />
                    <input type="text" asp-for="TsfPercentile" class="form-control col-md-2 mr-1 text-center" value="@setPercText(@formModel.TsfPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" readonly>
                    <input type="text" asp-for="TsfZscore" class="form-control col-md-2 mr-1 text-center" value="@setZscoreText(@formModel.TsfZscore,@formModel.AgeInYears,@formModel.AgeInMonths)" style="background-color: @setColor(formModel.TsfZscore)" readonly>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Triceps Skinfold Percentile" asp-controller="LineChart" asp-action="TSF_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.TricepsSkinFold);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Triceps Skinfold Z-score" asp-controller="LineChart" asp-action="TSF_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.TricepsSkinFold);return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
            <!-- BMI For Age -->
            <datalist id="tickmarks">
                <option value="0" label="0%"></option>
                <option value="25">25</option>
                <option value="50" title="50%" label="50%"></option>
                <option value="75">75</option>
                <option value="100" label="100%"></option>
            </datalist>

            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="text-nowrap col-md-3 mt-1 mr-1">BMI-for-Age</label>
                    <input id="BfaPercentileRange" class="form-control-range col-md-2 mr-1 ml-1" asp-for="BfaPercentile" type="range" min="0" max="100" step="25" title="@formModel.BfaPercentile" value="@formModel.BfaPercentile" list="tickmarks" disabled />
                    @if (formModel != null && formModel.Oedema == true)
                    {
                        <input type="text" asp-for="BfaPercentile" class="form-control col-md-2 mr-1 text-center" value="NA" readonly>
                        <input type="text" asp-for="BfaZscore" class="form-control col-md-2 mr-1 text-center" value="NA" style="background-color: @setColor(formModel.BfaZscore)" readonly>
                        <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="BMI-for-Age Percentile" asp-controller="LineChart" asp-action="BFA_P" onclick="return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                        <a class="btn btn-outline-secondary col-md-1 mr-1 disabled" data-toggle="tooltip" data-placement="top" title="BMI-for-Age Z-score" asp-controller="LineChart" asp-action="BFA_Z" onclick="return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                    }
                    else
                    {
                        <input type="text" asp-for="BfaPercentile" value="@setPercText(@formModel.BfaPercentile,@formModel.AgeInYears, @formModel.AgeInMonths)" class="form-control col-md-2 mr-1 text-center" readonly>
                        <input type="text" asp-for="BfaZscore" class="form-control col-md-2 mr-1 text-center" value="@formModel.BfaZscore.ToString("0.00")" style="background-color: @setColor(formModel.BfaZscore)" readonly>
                        <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="BMI-for-Age Percentile" asp-controller="LineChart" asp-action="BFA_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.BMI);return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                        <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="BMI-for-Age Z-score" asp-controller="LineChart" asp-action="BFA_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.BMI);return false">
                            <span class="oi oi-graph" aria-hidden="true"></span>
                        </a>
                    }
                </div>
            </div>
            <div class="form-group col-md-6">
                <div class="form-group row mb-0">
                    <label class="text-nowrap col-md-3 mt-1 mr-1">SSF-for-age</label>
                    <input id="SsfPercentileRange" class="form-control-range col-md-2 mr-1" asp-for="SsfPercentile" type="range" min="0" max="100" step="25" title="@setRangeControl(@formModel.SsfPercentile,@formModel.AgeInYears, @formModel.AgeInMonths)" value="@setRangeControl(@formModel.SsfPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" list="tickmarks" disabled />
                    <input type="text" asp-for="SsfPercentile" class="form-control col-md-2 mr-1 text-center" value="@setPercText(@formModel.SsfPercentile,@formModel.AgeInYears,@formModel.AgeInMonths)" readonly>
                    <input type="text" asp-for="SsfZscore" class="form-control col-md-2 mr-1 text-center" value="@setZscoreText(@formModel.SsfZscore,@formModel.AgeInYears,@formModel.AgeInMonths)" style="background-color: @setColor(formModel.SsfZscore)" readonly>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Subscapular Skinfold Percentile" asp-controller="LineChart" asp-action="SSF_P" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.SubscapularSkinFold );return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                    <a class="btn btn-outline-secondary col-md-1 mr-1" data-toggle="tooltip" data-placement="top" title="Subscapular Skinfold Z-score" asp-controller="LineChart" asp-action="SSF_Z" onclick="basicPopup(this.href + '?s=' + getRadioValue() + '&x=' + @formModel.AgeInMonths + '&y=' + @formModel.SubscapularSkinFold );return false">
                        <span class="oi oi-graph" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
        </div>
    </fieldset>
}
else if (loadFailed)
{
    <h1 style="text-align: center;">Unable to retrieve data due to an error.</h1>
}
else
{
    <h1 style="text-align: center;">Loading ...</h1>
}
@*<div class="alert alert-info mt-4" role="alert">
        <p> The BMI for a weight of @formModel.Weight kg and Length/height of @formModel.LengthHeight cm is @formModel.BMI.</p>
        <p> The age is @formModel.AgeString .</p>
        <p> The WFA Zscore is @formModel.WfaZscore.</p>
        <p> The WFA Percentile is @formModel.WfaPercentile.</p>
        <p> The MUAC Zscore is @formModel.MuacZscore.</p>
        <p> The MUAC Percentile is @formModel.MuacPercentile.</p>
        <p> The BFA Zscore is @formModel.BfaZscore.</p>
        <p> The BFA Percentile is @formModel.BfaPercentile.</p>
        <p> The HCA Zscore is @formModel.HcaZscore.</p>
        <p> The HCA Percentile is @formModel.HcaPercentile.</p>
        <p> The HFA Zscore is @formModel.HfaZscore.</p>
        <p> The HFA Percentile is @formModel.HfaPercentile.</p>
        <p> The LFA Zscore is @formModel.LfaZscore.</p>
        <p> The LFA Percentile is @formModel.LfaPercentile.</p>
        <p> The SFA Zscore is @formModel.SsfZscore.</p>
        <p> The SFA Percentile is @formModel.SsfPercentile.</p>
        <p> The TFA Zscore is @formModel.TsfZscore.</p>
        <p> The TFA Percentile is @formModel.TsfPercentile.</p>
        <p> The WFL Zscore is @formModel.WflZscore.</p>
        <p> The WFL Percentile is @formModel.WflPercentile.</p>
        <p> The WFH Zscore is @formModel.WfhZscore.</p>
        <p> The WFH Percentile is @formModel.WfhPercentile.</p>
    </div>*@