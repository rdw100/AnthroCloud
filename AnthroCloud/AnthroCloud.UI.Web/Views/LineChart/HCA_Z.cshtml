@{
    Layout = null;
}

<html>
<head>
    <title>Google Charts Tutorial</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" />
    <link href="~/lib/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', { packages: ['corechart', 'line'] });
    </script>
</head>
<body>
    <div id="chart_div">
        <div class="text-center" style="margin-top:200px;">
            <div class="spinner-border" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        google.charts.setOnLoadCallback(LoadData);

        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split('&');
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split('=');
                if (decodeURIComponent(pair[0]) == variable) {
                    return decodeURIComponent(pair[1]);
                }
            }
        }

        function LoadData() {
            var num = parseInt(getQueryVariable('sex'));

            $.ajax({

                url: '../LineChart/GetHCForAgeJson/' + num,
                dataType: "json",
                type: "GET",
                error: function (xhr, status, error) {
                    var err = eval("(" + xhr.responseText + ")");
                    toastr.error(err.message);
                },
                success: function (data) {
                    LoadChartData(data);
                    return false;
                }
            });
            return false;
        }

        function LoadChartData(data) {
            var dataArray = [
                [{ label: 'month', type: 'number' },
                    { label: 'Score', type: 'number' },
                    { label: '+3SD', type: 'number' },
                    { label: '+2SD', type: 'number' },
                    { label: '+1SD', type: 'number' },
                    { label: 'Median', type: 'number' },
                    { label: '-1SD', type: 'number' },
                    { label: '-2SD', type: 'number' },
                    { label: '-3SD', type: 'number' },
                ]
            ];

            $.each(data, function (i, item) {
                dataArray.push([item.month, item.score, item.sd3, item.sd2, item.sd1, item.sd0, item.sd1neg, item.sd2neg, item.sd3neg]);
            });

            var data = google.visualization.arrayToDataTable(dataArray);

            // Set chart options
            var options = {
                'title': 'HC-for-age',
                hAxis: {
                    title: 'Age (months)'
                },
                vAxis: {
                    title: 'Head circumference (cm)'
                },
                'width': 550,
                'height': 400,
                curveType: 'function',
                legend: 'right',
                pointSize: 0,
                series: {
                    0: { pointSize: 15, pointShape: { type: 'circle', sides: 5, dent: 0.8}, visibleInLegend: false, type: 'scatter'},
                    1: { color: '#000000' },
                    2: { color: '#e10808' },
                    3: { color: '#ffd700' },
                    4: { color: '#0c8d00' },
                    5: { color: '#ffd700' },
                    6: { color: '#e10808' },
                    7: { color: '#000000' }
                }
            };
            var chart = new google.visualization.LineChart(document.getElementById('chart_div'));

            chart.draw(data, options);
            return false;
        }
    </script>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
</body>
</html>